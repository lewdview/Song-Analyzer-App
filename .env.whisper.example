# Local Whisper Transcription Service Configuration
# Copy this file to .env and update values as needed

# Whisper Service URL
# The URL where your local transcription service is running
# Default: http://localhost:3001
WHISPER_SERVICE_URL=http://localhost:3001

# Frontend Whisper URL (browser -> local service)
# The React app reads this value to send transcription directly to local Whisper
VITE_WHISPER_SERVICE_URL=http://localhost:3001

# Runtime database mode for Tool Drop frontend:
# - og: use th3scr1b3 default project (good for OG version/demo)
# - custom: use buyer-owned Supabase project values below
VITE_DATABASE_MODE=og

# Buyer database values (used when VITE_DATABASE_MODE=custom)
VITE_CUSTOM_SUPABASE_PROJECT_ID=
VITE_CUSTOM_SUPABASE_ANON_KEY=

# Edge function path (shared by both modes)
VITE_SERVER_FUNCTION_PATH=make-server-473d7342

# Default lyrics AI provider sent by frontend to transcription service
# local | openai | claude | grok
VITE_LYRICS_AI_PROVIDER=local

# Whisper Service Port
# The port the transcription service listens on
# Default: 3001
WHISPER_PORT=3001

# Whisper Model / Decode Settings (local, no API key needed)
# Higher quality default for English songs:
WHISPER_MODEL=Xenova/whisper-medium.en
# Optional startup fallback order if WHISPER_MODEL fails to load:
WHISPER_FALLBACK_MODELS=Xenova/whisper-medium.en,Xenova/whisper-base.en
WHISPER_DEVICE=cpu
WHISPER_QUANTIZED=false
WHISPER_LANGUAGE=english
WHISPER_SAMPLE_RATE=16000
WHISPER_CHUNK_LENGTH_S=12
WHISPER_STRIDE_LENGTH_S=1.5
WHISPER_NUM_BEAMS=3
WHISPER_REPETITION_PENALTY=1.05
WHISPER_NO_REPEAT_NGRAM_SIZE=3
WHISPER_TIMESTAMP_MODE=segment
WHISPER_FORCE_WORD_TIMINGS=true
# `large` can fail on some @xenova/transformers runtimes. If you want to try it:
# WHISPER_MODEL=Xenova/whisper-large

# Lyrics analysis toggles
ENABLE_LYRICS_ANALYSIS=true
LOCAL_LYRICS_MIN_CHARS=24
ALLOW_LYRICS_PROVIDER_OVERRIDE=true

# Default provider at service level: local | openai | claude | grok
LYRICS_AI_PROVIDER=local

# Remote provider keys/models (only needed for chosen provider)
OPENAI_API_KEY=
OPENAI_LYRICS_MODEL=gpt-4o-mini

ANTHROPIC_API_KEY=
ANTHROPIC_LYRICS_MODEL=claude-3-5-sonnet-latest

XAI_API_KEY=
GROK_API_KEY=
XAI_LYRICS_MODEL=grok-2-latest
GROK_LYRICS_MODEL=grok-2-latest

# Optional: if you want automatic language detection, set this empty:
# WHISPER_LANGUAGE=

# Supabase Configuration (existing)
SUPABASE_URL=https://pznmptudgicrmljjafex.supabase.co
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB6bm1wdHVkZ2ljcm1samphZmV4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQzMDE4ODUsImV4cCI6MjA3OTg3Nzg4NX0.syu1bbr9OJ5LxCnTrybLVgsjac4UOkFVdAHuvhKMY2g
SUPABASE_SERVICE_ROLE_KEY=your-service-key-here

# === GETTING STARTED ===
#
# 1. Set WHISPER_SERVICE_URL to the address of your local Whisper service
#    (default is http://localhost:3001 if running locally)
#
# 2. Start the transcription service:
#    cd transcription-service && npm start
#
# 3. Set VITE_WHISPER_SERVICE_URL to the same host/port if needed
#
# 4. Your app will now use local transcription automatically (no OpenAI key required)
# 5. Optional: open Deployment Settings in-app to switch DB mode/provider without code edits
#
# === TROUBLESHOOTING ===
#
# Service not found?
# - Make sure the service is running: cd transcription-service && npm start
# - Check port 3001 is not in use: lsof -i :3001
# - Update WHISPER_SERVICE_URL if using different address/port
#
# Out of memory?
# - Edit transcription-service/server.js
# - Change model to Xenova/whisper-tiny.en (smallest/fastest)
#
# For more details, see WHISPER_LOCAL_SETUP.md and QUICK_START_WHISPER.md
